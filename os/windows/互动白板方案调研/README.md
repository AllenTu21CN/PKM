## 互动白板预研报告
[TOC]
 
****
### 1. 目的
* 市场有互动白板(IWB)的需求,所以需要相应的产品;为了确定产品的形态/方案,需要在预研阶段分析可行性,并提供初步方案；
* 同时为了满足试水市场的要求,须近期提供Demo.
 
#### 1.1 需求
* 远程桌面:

    主讲教室将本地桌面共享给参与的教室，并允许其操控

* 一对多:

    同时允许**N个**参与教室

* 多点触控:

    支持最多**十个**触控点，所有参与控制的教室共享该限制（Win10有望提高该限制）

* 多人同时操作:

    允许最多**五/十个**教室同时操控

* 白板程序:

    主讲教室的白板应用可以是**任意**的第三方程序

* 网络环境:

    第一阶段支持**内部**网络，后续根据市场需求解决公网传输问题

* 平台支持:

    第一阶段支持**Win7**，后续增加Win8/Win10支持

* 多媒体播放:

    主讲教室播放音视频时，参与教室能获得**基本/良好**的体验

#### 1.2 形态
* 形式: 业务UI+服务进程+驱动程序
* 操作流程
    1. 主讲教室通过UI配置相关信息后开启一次白板互动“课程”（UI可以最小化到托盘），然后打开白板软件，比如希沃白板软件；
    2. 参与教室通过UI配置相关信息后连接到主讲教室的“课程”，从UI窗口中看到主讲的桌面画面/声音（支持全屏）；
    3. 主讲教室允许远程控制后，参与教室直接在UI窗口内操作，操作实时反映在主讲的白板软件上，并反馈给所有教室；

****
### 2. 市场了解
| 产品   | 一对多 | 多点触控 | 同时操作 | 音视频 | 内外网 | 开源 | API |
| ------ | ------ | -------- | -------- | ------ | ------ | ---- | --- |
|AnyDesk |Y       |-         |N         |Y       |Y       |N     |N    |
|TeamView|Y       |-         |N         |Y       |Y       |N     |N    |
|VNC     |N       |N         |N         |Y       |N       |Y     |Y    |

****
### 3. 初步方案
该方案是结合第一阶段调研结果和第一阶段需求的Demo方案,并不是产品的最终设计方案。

#### 3.1 整体框架
##### 3.1.1 主讲教室
![](http://git.3bu.cn/tuyj/my-doc-sharing/raw/f3c42668b3923cf40a17f760cf3220b74b78c062/Project/iwb/research/Host.png)
* LDS(LocalDesktop Sharer)
    * 获取本地桌面和声音；
    * 编码；
    * 码流发送;
* VMTC(VirtualMultipleTouch Collector/Client)
    * 获取参与教室发送的触控数据，并做数据jitter；
    * 将触控数据发送给下层驱动；
* MC(Management Console)
    * 配置本地程序
    * 开启白板课程
    * 课程信令
* VMTD(Virtual MultipleTouch Driver)
    * 接收/转发 虚拟/真实触控数据

##### 3.1.2 参与教室
![](http://git.3bu.cn/tuyj/my-doc-sharing/raw/f3c42668b3923cf40a17f760cf3220b74b78c062/Project/iwb/research/Remote.png)
* RDPlayer
    * 网络接收音视频码流；
    * 解码
    * 播放到UI窗口
* MTC(MultipleTouch Capturer)
    * 捕获UI窗口内的触控信息，并格式化转换
    * 发送到主讲搜集器
* MC(Management Console)
    * 配置本地程序
    * 参与课程
    * 课程信令

##### 3.1.3 传输预览
![](http://git.3bu.cn/tuyj/my-doc-sharing/raw/f3c42668b3923cf40a17f760cf3220b74b78c062/Project/iwb/research/Trans.png)

#### 3.2 VMTD设计
* 模型预览
![](http://git.3bu.cn/tuyj/my-doc-sharing/raw/f3c42668b3923cf40a17f760cf3220b74b78c062/Project/iwb/research/VMTDes.png)
* 数据流预览
![](http://git.3bu.cn/tuyj/my-doc-sharing/raw/f3c42668b3923cf40a17f760cf3220b74b78c062/Project/iwb/research/VMTData.png)
* TODO
    * 驱动安装方式、设备查找
    * 硬件设备兼容问题，解决report description获取问题

#### 3.3 桌面共享
参考VNC源码和鲁彬彬桌面共享前探代码；

待进一步调研；

#### 3.4 网络传输
媒体数据的传输放在*桌面共享*部分分析，此处网络传输主要研究如何**可靠、低延迟、高频率**地传输触控信息以得到快速、平滑的触控体验。
* TCP
* RUDP/RTP/UDT
* KCP
* 根据触控事件的特性,封装UDP

需要进一步调研；

****
### 4. 项目计划&评估
#### 4.1 技术点调研-1
* 触控模拟（2016.08.11～2016.08.12）（本周）
    * 触控Demo
* 桌面共享（2016-08-15~2016-09-02）（3周）
    * 确定方案
    * 桌面共享Demo

#### 4.2 PreDemo
2016-09-05~2016-09-09（5-8天）
提供给其他部门，作为市场试水的Demo    **<里程碑1>**


**Note: 这个Demo需求完成程度将会影响工作量**

#### 4.3 技术点调研-2
* 网络传输（2016-09-12~2016-09-16）（1周-1天）
* 声音/画面/触控同步机制（2016-09-19~2016-09-23）（1周）
* 内网穿透（2016-09-26~2016-09-30）（1周）
    该技术点的调研应浅尝辄止，不需要具体实现，只作为产品设计阶段的参考，为以后解决公网传输预留设计。

#### 4.4 产品原型Demo
2016-10-08~2016-10-14（1周+）
* 根据产品需求，整合各技术点，提供正式的产品Demo    **<里程碑2>**
* 技术预研报告(含原型性能测试)

#### 4.5 项目开发
* 设计
    * 需求分析/细化和产品框架设计(产品部参与)
    * 模块设计
    * 接口设计和内部测试设计
    * 模块详细设计
    * 设计阶段小节和工作量详细评估(须产品/测试参与)    **<里程碑3>**
* 开发
    * 第一阶段开发    **<里程碑4>**
    * 模块自测和单元测试
    * 联调
    * 性能自测
    * 优化与重构-1    **<里程碑5>**
* 测试
    * Debug
    * 优化与重构-2
* 发布和维护    **<里程碑6>**

### 5. TODO
* 开发*桌面共享*需要相关设备
